<header class="top-header">
    <div class="header-left">
        <span class="site-title">Top Charts Fund</span>
    </div>
</header>

<div *ngIf="fundData" class="fund-detail-container">
    
    <header class="detail-header">
        <h1>{{ fundData.FundName }} ({{ fundData.Company }})
            <div class="nav-info">
                <span class="nav-label">NAV: </span>
                <span class="nav-value">{{ fundData.NAV }}</span>
            </div>
        </h1>
    </header>

    <div class="main-content-area">
        <div class="key-metrics-box">
            <h3>ข้อมูลสำคัญ</h3>
            <p><strong>ประเภทกองทุน:</strong> {{ fundData.Category }}</p>
            <p><strong>มูลค่าสินทรัพย์สุทธิ:</strong> {{ fundData.AUM}}</p>
            <p><strong>วันที่จดทะเบียน:</strong> {{ fundData.RegisterDate }}</p>
            <p><strong>ความเสี่ยง:</strong> <span class="risk-level-{{ fundData.RiskLevel }}"> {{ fundData.RiskLevel }}</span></p>
        </div>
    </div>
    
    <div class="chart-area">
        <h2>กราฟราคา NAV</h2>
        <dx-chart id="nav-chart" [dataSource]="navHistoryData">
            <dxi-series argumentField="Date" valueField="NAV" type="line" color="#00AEEF" name="NAV"></dxi-series>
            <dxo-argument-axis argumentType="datetime"></dxo-argument-axis>
            <dxo-tooltip [enabled]="true" title="{point.argument}"></dxo-tooltip>
        </dx-chart>
    </div>

    <div class="performance-table" style="margin-bottom: 30px;">
        <h2>ผลตอบแทนย้อนหลัง</h2>
        
        <dx-data-grid 
            [dataSource]="performanceData" 
            [width]="'100%'" 
            [showBorders]="true" 
            [showColumnHeaders]="true"
            [showRowLines]="true"
            [columnAutoWidth]="false" 
            [rowAlternationEnabled]="false"> 
            
            <dxi-column dataField="Fundname" caption="กองทุน" alignment="left">
                <div *dxTemplate="let data of 'cell'">
                    <div class="fund-performance-cell" style="display: flex; align-items: center;">
                        <span style="width:250px; height: 250px; background:#007bff; margin-right:5px; display:inline-block;"></span>
                        <span style="font-weight: bold;">{{ data.data.Fundname }}</span>
                    </div>
                </div>
            </dxi-column>

            <dxi-column dataField="R_1D" caption="1 วัน" alignment="center" [width]="180" cellTemplate="returnCell"></dxi-column>
            <dxi-column dataField="R_1M" caption="1 เดือน" alignment="center" [width]="180" cellTemplate="returnCell"></dxi-column>
            <dxi-column dataField="R_1Y" caption="1 ปี" alignment="center" [width]="180" cellTemplate="returnCell"></dxi-column>
            <dxi-column dataField="R_3Y" caption="3 ปี" alignment="center" [width]="180" cellTemplate="returnCell"></dxi-column>
            <dxi-column dataField="R_5Y" caption="5 ปี" alignment="center" [width]="180" cellTemplate="returnCell"></dxi-column>
            
            <div *dxTemplate="let data of 'returnCell'">
                <span [ngClass]="{'negative-return': data.value < 0, 'positive-return': data.value >= 0}" 
                      style="font-weight: bold;" alignment="center;"
                      [style.color]="data.value < 0 ? 'red' : 'green'">
                    {{ data.value}}%
                </span>
            </div>

            <dxo-pager [visible]="false"></dxo-pager>
        </dx-data-grid>
    </div>
        
    <div class="action-buttons-container" style="display: flex; justify-content: center; gap: 15px; margin-bottom: 30px;">
        <dx-button 
            text="ซื้อกองทุน" 
            type="success" 
            [width]="200" 
            [height]="50"
            [elementAttr]="{ style: 'font-size: 18px; font-weight: bold;' }"
            (onClick)="navigateToBuy()">
        </dx-button>

        <dx-button 
            text="ขาย" 
            type="danger" 
            [width]="200" 
            [height]="50"
            [elementAttr]="{ style: 'font-size: 18px; font-weight: bold;' }"
            (onClick)="navigateToSell()">
        </dx-button>
    </div>

     <br>
    <a routerLink="/" class="pi pi-backward back-link"> กลับหน้าแรก</a>
</div>