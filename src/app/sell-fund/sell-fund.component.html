<header class="top-header">
    <div class="header-left">
        <span class="site-title">Top Charts Fund</span>
    </div>
</header>
<div class="buy-sell-container">
    <div class="header-section sell-mode">
        <h2>üîª ‡∏Ç‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡∏á‡∏ó‡∏∏‡∏ô</h2>
        <div class="fund-id-tag">ID: {{ fundId }}</div>
    </div>
    <h3 style="margin-top: 0; color: #333;">{{ fundData?.FundName }}</h3>

    <div class="portfolio-card sell-style">
        <div class="info-row">
            <span>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ:</span>
            <strong>{{ heldUnits | number:'1.4-4' }} ‡∏´‡∏ô‡πà‡∏ß‡∏¢</strong>
        </div>
        <div class="info-row">
            <span>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (NAV {{ fundData?.NAV }}):</span>
            <strong>{{ heldUnits * fundData?.NAV | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó</strong>
        </div>
    </div>

    <div class="form-area dx-fieldset">
        
        <div style="margin-bottom: 20px;">
            <dx-check-box 
                text="‡∏Ç‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Sell All)" 
                [(value)]="sellAllUnits"
                (onValueChanged)="updateSellAmount()">
            </dx-check-box>
        </div>

        <div class="dx-field">
            <div class="dx-field-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢:</div>
            <div class="dx-field-value">
                <dx-number-box 
                    [(value)]="sellAmount" 
                    [max]="heldUnits" 
                    [min]="0"
                    format="#,##0.0000"
                    (onValueChanged)="onAmountChange()">
                </dx-number-box>
            </div>
        </div>

        <div class="dx-field">
            <div class="dx-field-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</div>
            <div class="dx-field-value">
                <dx-date-box [value]="today" [min]="today" displayFormat="dd/MM/yyyy" type="date"></dx-date-box>
            </div>
        </div>

        <div class="summary-box">
            <div class="dx-field">
                <div class="dx-field-label">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°:</div>
                <div class="dx-field-value" style="text-align: right; font-weight: bold;">
                    {{ sellAmount * fundData?.NAV | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó
                </div>
            </div>
            <div class="dx-field">
                <div class="dx-field-label">‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏° (2%):</div>
                <div class="dx-field-value fee-text" style="text-align: right;">
                    - {{ calculateFee(sellAmount * fundData?.NAV, 0.02) | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó
                </div>
            </div>
            <hr style="border: 0; border-top: 1px solid #ccc; margin: 10px 0;">
            <div class="dx-field">
                <div class="dx-field-label" style="align-self: flex-end;">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö:</div>
                <div class="dx-field-value net-amount" style="text-align: right;">
                    {{ (sellAmount * fundData?.NAV) - calculateFee(sellAmount * fundData?.NAV, 0.02) | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <dx-button 
                text="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Ç‡∏≤‡∏¢" 
                type="danger" 
                [width]="'100%'" 
                [height]="50"
                [disabled]="sellAmount <= 0 || sellAmount > heldUnits"
                (onClick)="confirmSell()">
            </dx-button>
        </div>

        <div *ngIf="sellSuccess" class="success-message">
            <i class="pi pi-check-circle" style="font-size: 2rem;"></i>
            <h3>‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Ç‡∏≤‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
        </div>
    </div>
</div>

<div class="back-nav">
    <a routerLink="/" class="pi pi-backward"> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
</div>